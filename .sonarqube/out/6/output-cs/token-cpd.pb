Ç	
rC:\Users\s1124\OneDrive - sbnasoftware.com\Desktop\ASP.Net\MagicVilla\MagicVilla_Web\Controllers\HomeController.cs
	namespace 	
MagicVilla_Web
 
. 
Controllers $
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
private 
readonly 
ILogger  
<  !
HomeController! /
>/ 0
_logger1 8
;8 9
public

 
HomeController

 
(

 
ILogger

 %
<

% &
HomeController

& 4
>

4 5
logger

6 <
)

< =
{ 	
_logger 
= 
logger 
; 
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
public 
IActionResult 
Privacy $
($ %
)% &
{ 	
return 
View 
( 
) 
; 
} 	
} 
} ï9
sC:\Users\s1124\OneDrive - sbnasoftware.com\Desktop\ASP.Net\MagicVilla\MagicVilla_Web\Controllers\VillaController.cs
	namespace 	
MagicVilla_Web
 
. 
Controllers $
{		 
public

 

class

 
VillaController

  
:

! "

Controller

# -
{ 
private 
readonly 
IVillaService &
_villaService' 4
;4 5
private 
readonly 
IMapper  
_mapper! (
;( )
public 
VillaController 
( 
IVillaService ,
villaService- 9
,9 :
IMapper; B
mapperC I
)I J
{ 	
_villaService 
= 
villaService (
;( )
_mapper 
= 
mapper 
; 
} 	
public 
async 
Task 
< 
IActionResult '
>' (

IndexVilla) 3
(3 4
)4 5
{ 	
List 
< 
VillaDto 
> 
list 
=  !
new" %
(% &
)& '
;' (
var 
response 
= 
await  
_villaService! .
.. /
GetAllAsync/ :
<: ;
APIResponse; F
>F G
(G H
)H I
;I J
if 
( 
response 
!= 
null  
&&! #
response$ ,
., -
	IsSuccess- 6
)6 7
{ 
list 
= 
JsonConvert "
." #
DeserializeObject# 4
<4 5
List5 9
<9 :
VillaDto: B
>B C
>C D
(D E
ConvertE L
.L M
ToStringM U
(U V
responseV ^
.^ _
Result_ e
)e f
)f g
;g h
} 
return 
View 
( 
list 
) 
; 
} 	
public 
async 
Task 
< 
IActionResult '
>' (
CreateVilla) 4
(4 5
)5 6
{ 	
return   
View   
(   
)   
;   
}!! 	
["" 	
HttpPost""	 
]"" 
[## 	$
ValidateAntiForgeryToken##	 !
]##! "
public$$ 
async$$ 
Task$$ 
<$$ 
IActionResult$$ '
>$$' (
CreateVilla$$) 4
($$4 5
VillaCreateDto$$5 C
model$$D I
)$$I J
{%% 	
if&& 
(&& 

ModelState&& 
.&& 
IsValid&& !
)&&! "
{'' 
var(( 
response(( 
=(( 
await(( $
_villaService((% 2
.((2 3
CreateAsync((3 >
<((> ?
APIResponse((? J
>((J K
(((K L
model((L Q
)((Q R
;((R S
if)) 
()) 
response)) 
!=)) 
null)) #
&&))$ &
response))' /
.))/ 0
	IsSuccess))0 9
)))9 :
{** 
return++ 
RedirectToAction++ +
(+++ ,
nameof++, 2
(++2 3

IndexVilla++3 =
)++= >
)++> ?
;++? @
},, 
}-- 
return.. 
View.. 
(.. 
model.. 
).. 
;.. 
}// 	
public00 
async00 
Task00 
<00 
IActionResult00 '
>00' (
UpdateVilla00) 4
(004 5
int005 8
villaId009 @
)00@ A
{11 	
var22 
response22 
=22 
await22  
_villaService22! .
.22. /
GetAsync22/ 7
<227 8
APIResponse228 C
>22C D
(22D E
villaId22E L
)22L M
;22M N
if33 
(33 
response33 
!=33 
null33  
&&33! #
response33$ ,
.33, -
	IsSuccess33- 6
)336 7
{44 
VillaDto55 
model55 
=55  
JsonConvert55! ,
.55, -
DeserializeObject55- >
<55> ?
VillaDto55? G
>55G H
(55H I
Convert55I P
.55P Q
ToString55Q Y
(55Y Z
response55Z b
.55b c
Result55c i
)55i j
)55j k
;55k l
return66 
View66 
(66 
_mapper66 #
.66# $
Map66$ '
<66' (
VillaUpdateDto66( 6
>666 7
(667 8
model668 =
)66= >
)66> ?
;66? @
}77 
return88 
NotFound88 
(88 
)88 
;88 
}99 	
[;; 	
HttpPost;;	 
];; 
[<< 	$
ValidateAntiForgeryToken<<	 !
]<<! "
public== 
async== 
Task== 
<== 
IActionResult== '
>==' (
UpdateVilla==) 4
(==4 5
VillaUpdateDto==5 C
model==D I
)==I J
{>> 	
if?? 
(?? 

ModelState?? 
.?? 
IsValid?? "
)??" #
{@@ 
varAA 
responseAA 
=AA 
awaitAA $
_villaServiceAA% 2
.AA2 3
UpdateAsyncAA3 >
<AA> ?
APIResponseAA? J
>AAJ K
(AAK L
modelAAL Q
)AAQ R
;AAR S
ifBB 
(BB 
responseBB 
!=BB 
nullBB  $
&&BB% '
responseBB( 0
.BB0 1
	IsSuccessBB1 :
)BB: ;
{CC 
returnDD 
RedirectToActionDD +
(DD+ ,
nameofDD, 2
(DD2 3

IndexVillaDD3 =
)DD= >
)DD> ?
;DD? @
}EE 
}FF 
returnGG 
ViewGG 
(GG 
modelGG 
)GG 
;GG 
}HH 	
publicJJ 
asyncJJ 
TaskJJ 
<JJ 
IActionResultJJ '
>JJ' (
DeleteVillaJJ) 4
(JJ4 5
intJJ5 8
villaIdJJ9 @
)JJ@ A
{KK 	
ifLL 
(LL 

ModelStateLL 
.LL 
IsValidLL !
)LL! "
{MM 
ifNN 
(NN 
villaIdNN 
!=NN 
$numNN 
)NN  
{OO 
awaitPP 
_villaServicePP '
.PP' (
DeleteAsyncPP( 3
<PP3 4
APIResponsePP4 ?
>PP? @
(PP@ A
villaIdPPA H
)PPH I
;PPI J
returnQQ 
RedirectToActionQQ +
(QQ+ ,
nameofQQ, 2
(QQ2 3

IndexVillaQQ3 =
)QQ= >
)QQ> ?
;QQ? @
}RR 
}SS 
returnTT 
ViewTT 
(TT 
villaIdTT 
)TT  
;TT  !
}UU 	
}VV 
}WW ù

gC:\Users\s1124\OneDrive - sbnasoftware.com\Desktop\ASP.Net\MagicVilla\MagicVilla_Web\Mapper\Profiles.cs
	namespace 	
MagicVilla_VillaAPI
 
. 
Mapper $
{ 
public 

class 
Profiles 
: 
Profile "
{ 
public		 
Profiles		 
(		 
)		 
{

 	
	CreateMap 
< 
VillaCreateDto $
,$ %
VillaDto& .
>. /
(/ 0
)0 1
.1 2

ReverseMap2 <
(< =
)= >
;> ?
	CreateMap 
< 
VillaUpdateDto $
,$ %
VillaDto& .
>. /
(/ 0
)0 1
.1 2

ReverseMap2 <
(< =
)= >
;> ?
	CreateMap 
<  
VillaNumberCreateDto *
,* +
VillaNumberDto, :
>: ;
(; <
)< =
.= >

ReverseMap> H
(H I
)I J
;J K
	CreateMap 
<  
VillaNumberUpdateDto *
,* +
VillaNumberDto, :
>: ;
(; <
)< =
.= >

ReverseMap> H
(H I
)I J
;J K
} 	
} 
} µ
_C:\Users\s1124\OneDrive - sbnasoftware.com\Desktop\ASP.Net\MagicVilla\MagicVilla_Web\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder		 
.		 
Services		 
.		 #
AddControllersWithViews		 (
(		( )
)		) *
;		* +
builder

 
.

 
Services

 
.

 
AddAutoMapper

 
(

 
typeof

 %
(

% &
Profiles

& .
)

. /
.

/ 0
Assembly

0 8
)

8 9
;

9 :
builder 
. 
Services 
. 
AddHttpClient 
< 
IVillaService ,
,, -
VillaService. :
>: ;
(; <
)< =
;= >
builder 
. 
Services 
. 
	AddScoped 
< 
IVillaService (
,( )
VillaService) 5
>5 6
(6 7
)7 8
;8 9
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
! 
app 
. 	
Environment	 
. 
IsDevelopment "
(" #
)# $
)$ %
{ 
app 
. 
UseExceptionHandler 
( 
$str )
)) *
;* +
app 
. 
UseHsts 
( 
) 
; 
} 
app 
. 
UseHttpsRedirection 
( 
) 
; 
app 
. 
UseStaticFiles 
( 
) 
; 
app 
. 

UseRouting 
( 
) 
; 
app 
. 
UseAuthorization 
( 
) 
; 
app 
. 
MapControllerRoute 
( 
name   
:   	
$str  
 
,   
pattern!! 
:!! 
$str!! 5
)!!5 6
;!!6 7
app## 
.## 
Run## 
(## 
)## 	
;##	 
