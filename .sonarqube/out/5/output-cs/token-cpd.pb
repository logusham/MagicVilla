œ.
gC:\Users\s1124\OneDrive - sbnasoftware.com\Desktop\ASP.Net\MagicVilla\MagicVilla_Service\BaseService.cs
	namespace 	
MagicVilla_Web
 
. 
Services !
{		 
public

 

class

 
BaseService

 
:

 
IBaseService

 +
{ 
public 
APIResponse 
responseModel (
{) *
get+ .
;/ 0
set1 4
;5 6
}7 8
public 
IHttpClientFactory !

httpClient" ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
BaseService 
( 
IHttpClientFactory -

httpClient. 8
)8 9
{ 	
this 
. 
responseModel 
=  
new! $
($ %
)% &
;& '
this 
. 

httpClient 
= 

httpClient (
;( )
} 	
public 
async 
Task 
< 
T 
> 
	SendAsync &
<& '
T' (
>( )
() *

APIRequest* 4

aPIRequest5 ?
)? @
{ 	
try 
{ 
var 
client 
= 

httpClient '
.' (
CreateClient( 4
(4 5
$str5 ?
)? @
;@ A
HttpRequestMessage "
message# *
=+ ,
new- 0
HttpRequestMessage1 C
(C D
)D E
;E F
message 
. 
Headers 
.  
Add  #
(# $
$str$ ,
,, -
$str. @
)@ A
;A B
message 
. 

RequestUri "
=# $
new% (
Uri) ,
(, -

aPIRequest- 7
.7 8
Url8 ;
); <
;< =
if 
( 

aPIRequest 
. 
Data #
!=$ &
null' +
)+ ,
{ 
message   
.   
Content   #
=  $ %
new  & )
StringContent  * 7
(  7 8
JsonConvert  8 C
.  C D
SerializeObject  D S
(  S T

aPIRequest  T ^
.  ^ _
Data  _ c
)  c d
,  d e
Encoding!!  
.!!  !
UTF8!!! %
,!!% &
$str!!' 9
)!!9 :
;!!: ;
}"" 
switch## 
(## 

aPIRequest## "
.##" #
ApiType### *
)##* +
{$$ 
case%% 
SD%% 
.%% 
ApiType%% #
.%%# $
POST%%$ (
:%%( )
message&& 
.&&  
Method&&  &
=&&' (

HttpMethod&&) 3
.&&3 4
Post&&4 8
;&&8 9
break'' 
;'' 
case(( 
SD(( 
.(( 
ApiType(( #
.((# $
PUT(($ '
:((' (
message)) 
.))  
Method))  &
=))' (

HttpMethod))) 3
.))3 4
Put))4 7
;))7 8
break** 
;** 
case++ 
SD++ 
.++ 
ApiType++ #
.++# $
DELETE++$ *
:++* +
message,, 
.,,  
Method,,  &
=,,' (

HttpMethod,,) 3
.,,3 4
Delete,,4 :
;,,: ;
break-- 
;-- 
default.. 
:.. 
message// 
.//  
Method//  &
=//' (

HttpMethod//) 3
.//3 4
Get//4 7
;//7 8
break00 
;00 
}11 
HttpResponseMessage22 #
?22# $
apiResponse22% 0
=221 2
null223 7
;227 8
apiResponse33 
=33 
await33 #
client33$ *
.33* +
	SendAsync33+ 4
(334 5
message335 <
)33< =
;33= >
var44 

apiContent44 
=44  
await44! &
apiResponse44' 2
.442 3
Content443 :
.44: ;
ReadAsStringAsync44; L
(44L M
)44M N
;44N O
var55 
APIResponse55 
=55  !
JsonConvert55" -
.55- .
DeserializeObject55. ?
<55? @
T55@ A
>55A B
(55B C

apiContent55C M
)55M N
;55N O
return66 
APIResponse66 "
;66" #
}77 
catch77 
(77 
	Exception77 
ex77 
)77  
{88 
var99 
dto99 
=99 
new99 
APIResponse99 )
{:: 
ErrorMessages;; !
=;;" #
new;;$ '
List;;( ,
<;;, -
string;;- 3
>;;3 4
{;;5 6
Convert;;7 >
.;;> ?
ToString;;? G
(;;G H
ex;;H J
.;;J K
Message;;K R
);;R S
};;T U
,;;U V
	IsSuccess<< 
=<< 
false<<  %
}== 
;== 
var>> 
res>> 
=>> 
JsonConvert>> %
.>>% &
SerializeObject>>& 5
(>>5 6
dto>>6 9
)>>9 :
;>>: ;
var?? 
APIResponse?? 
=??  !
JsonConvert??" -
.??- .
DeserializeObject??. ?
<??? @
T??@ A
>??A B
(??B C
res??C F
)??F G
;??G H
return@@ 
APIResponse@@ "
;@@" #
}AA 
}BB 	
}CC 
}DD Þ
qC:\Users\s1124\OneDrive - sbnasoftware.com\Desktop\ASP.Net\MagicVilla\MagicVilla_Service\IService\IBaseService.cs
	namespace 	
MagicVilla_Web
 
. 
Services !
.! "
	IServices" +
{ 
public 

	interface 
IBaseService !
{ 
APIResponse 
responseModel !
{" #
get$ '
;' (
set) ,
;, -
}. /
Task		 
<		 
T		 
>		 
	SendAsync		 
<		 
T		 
>		 
(		 

APIRequest		 '

aPIRequest		( 2
)		2 3
;		3 4
}

 
} ß

rC:\Users\s1124\OneDrive - sbnasoftware.com\Desktop\ASP.Net\MagicVilla\MagicVilla_Service\IService\IVillaService.cs
	namespace 	
MagicVilla_Service
 
. 
IService %
{ 
public 

	interface 
IVillaService "
{ 
Task 
< 
T 
> 
GetAllAsync 
< 
T 
> 
( 
)  
;  !
Task 
< 
T 
> 
GetAsync 
< 
T 
> 
( 
int 
id  "
)" #
;# $
Task		 
<		 
T		 
>		 
CreateAsync		 
<		 
T		 
>		 
(		 
VillaCreateDto		 -
dto		. 1
)		1 2
;		2 3
Task

 
<

 
T

 
>

 
UpdateAsync

 
<

 
T

 
>

 
(

 
VillaUpdateDto

 -
dto

. 1
)

1 2
;

2 3
Task 
< 
T 
> 
DeleteAsync 
< 
T 
> 
( 
int "
id# %
)% &
;& '
} 
} €'
hC:\Users\s1124\OneDrive - sbnasoftware.com\Desktop\ASP.Net\MagicVilla\MagicVilla_Service\VillaService.cs
	namespace 	
MagicVilla_Service
 
{		 
public

 

class

 
VillaService

 
:

 
BaseService

  +
,

+ ,
IVillaService

- :
{ 
private 
readonly 
IHttpClientFactory +
_httpClientFactory, >
;> ?
private 
string 
villaUrl 
;  
public 
VillaService 
( 
IHttpClientFactory .
httpClientFactory/ @
,@ A
IConfigurationB P
configurationQ ^
)^ _
:` a
baseb f
(f g
httpClientFactoryg x
)x y
{ 	
this 
. 
_httpClientFactory #
=$ %
httpClientFactory& 7
;7 8
villaUrl 
= 
configuration $
.$ %
GetValue% -
<- .
string. 4
>4 5
(5 6
$str6 L
)L M
;M N
} 	
public 
Task 
< 
T 
> 
CreateAsync "
<" #
T# $
>$ %
(% &
VillaCreateDto& 4
dto5 8
)8 9
{ 	
return 
	SendAsync 
< 
T 
> 
(  
new  #

APIRequest$ .
(. /
)/ 0
{ 
ApiType 
= 
SD 
. 
ApiType $
.$ %
POST% )
,) *
Url 
= 
villaUrl 
+ 
$str .
,. /
Data 
= 
dto 
} 
) 
; 
} 	
public 
Task 
< 
T 
> 
DeleteAsync "
<" #
T# $
>$ %
(% &
int& )
id* ,
), -
{ 	
return 
	SendAsync 
< 
T 
> 
(  
new  #

APIRequest$ .
(. /
)/ 0
{   
ApiType!! 
=!! 
SD!! 
.!! 
ApiType!! $
.!!$ %
DELETE!!% +
,!!+ ,
Url"" 
="" 
villaUrl"" 
+""  
$str""! 1
+""1 2
id""2 4
}## 
)## 
;## 
}$$ 	
public&& 
Task&& 
<&& 
T&& 
>&& 
GetAllAsync&& "
<&&" #
T&&# $
>&&$ %
(&&% &
)&&& '
{'' 	
return(( 
	SendAsync(( 
<(( 
T(( 
>(( 
(((  
new((  #

APIRequest(($ .
(((. /
)((/ 0
{)) 
ApiType** 
=** 
SD** 
.** 
ApiType** $
.**$ %
GET**% (
,**( )
Url++ 
=++ 
villaUrl++ 
+++  
$str++! 0
},, 
),, 
;,, 
}-- 	
public// 
Task// 
<// 
T// 
>// 
GetAsync// 
<//  
T//  !
>//! "
(//" #
int//# &
id//' )
)//) *
{00 	
return11 
	SendAsync11 
<11 
T11 
>11 
(11  
new11  #

APIRequest11$ .
(11. /
)11/ 0
{22 
ApiType33 
=33 
SD33 
.33 
ApiType33 $
.33$ %
GET33% (
,33( )
Url44 
=44 
villaUrl44 
+44  
$str44! 1
+441 2
id442 4
}55 
)55 
;55 
}66 	
public88 
Task88 
<88 
T88 
>88 
UpdateAsync88 "
<88" #
T88# $
>88$ %
(88% &
VillaUpdateDto88& 4
dto885 8
)888 9
{99 	
return:: 
	SendAsync:: 
<:: 
T:: 
>:: 
(::  
new::  #

APIRequest::$ .
(::. /
)::/ 0
{;; 
ApiType<< 
=<< 
SD<< 
.<< 
ApiType<< $
.<<$ %
PUT<<% (
,<<( )
Url== 
=== 
villaUrl== 
+==  
$str==! 1
+==1 2
dto==2 5
.==5 6
Id==6 8
,==8 9
Data>> 
=>> 
dto>> 
}?? 
)?? 
;?? 
}@@ 	
}AA 
}BB 